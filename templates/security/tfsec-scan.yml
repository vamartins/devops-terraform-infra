.tfsec-scan:
  image:
    name: aquasec/tfsec:$TFSEC_VERSION
    entrypoint: [""]
  variables:
    TFSEC_VERSION: v0.56
    TFSEC_SRC: infra
    TFSEC_EXCLUDE_CHECK: ""
    TFSEC_FORMAT: default
    TFSEC_TFVARS_FILE: ""
    TFSEC_OUT_FILE: ""
    TFSEC_INTERNAL_TFVARS_ARG: ""
    TFSEC_INTERNAL_OUT_ARG: ""
  script:
    - if [[ ! -z "$TFSEC_TFVARS_FILE" ]]; then TFSEC_INTERNAL_TFVARS_ARG="--tfvars-file $TFSEC_TFVARS_FILE"; fi
    - if [[ ! -z "$TFSEC_OUT_FILE" ]]; then TFSEC_INTERNAL_OUT_ARG="--out $TFSEC_OUT_FILE"; fi
    - tfsec $TFSEC_SRC --exclude $TFSEC_EXCLUDE_CHECK --format $TFSEC_FORMAT $TFSEC_INTERNAL_TFVARS_ARG $TFSEC_INTERNAL_OUT_ARG